<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2020-12-30 Wed 21:31 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>用AI画出手写风格的图</title>
<meta name="generator" content="Org mode">

<meta name="google-site-verification" content="dVWCUwH8eYXavYgAUJtgmzwlXVIcYZeyvlUolZQVb2E" />
<link rel="stylesheet" type="text/css" href="/assets/css/style.css"/>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
<div class="content-wrapper container">
   <div class="row"> <div class="col"> </div>   <div class="col-sm-6 col-md-8">
<div id="preamble" class="status">

<div class="">
    <a href="/"> Luhua.ei </a>
</div>
<ul class="">
  <li><a href="/about.html"> About Me </a> </li>
  <li><a href="https://github.com/luhuaei"> Github </a> </li>
  <li><a href="/archive.html"> Posts </a> </li>
</ul>
  <hr>
</div>
<div id="content">
<header>
<h1 class="title">用AI画出手写风格的图</h1>
</header><div id="outline-container-orged710a2" class="outline-2">
<h2 id="orged710a2">整体概要</h2>
<div class="outline-text-2" id="text-orged710a2">
<ul class="org-ul">
<li>目标：
<ul class="org-ul">
<li>使用AI生成具有手写风格的图片。</li>
<li>可以将人们手写图片的风格记录下来，用来生成一些独特的图片。</li>
</ul></li>
<li>思路：
<ul class="org-ul">
<li>使用QuickDraw的数据训练模型。</li>
<li>对神经网络具有更加深入的了解。</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org364b2ae" class="outline-2">
<h2 id="org364b2ae">依赖加载</h2>
<div class="outline-text-2" id="text-org364b2ae">
<div class="org-src-container">
<pre class="src src-jupyter-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

import ndjson                   # 解析ndjson文件
import json
</pre>
</div>
</div>
</div>

<div id="outline-container-org6c463eb" class="outline-2">
<h2 id="org6c463eb">加载数据</h2>
<div class="outline-text-2" id="text-org6c463eb">
<p>
先尝试使用baseball<sub>bat数据集</sub>，后面可以只需改变数据集就可以了。
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">with open("/home/luhuaei/Data/google-quickdarw/baseball_bat.ndjson", 'r') as f:
    # pandas provice many utils function
    DATA_BASEBALL = pd.DataFrame(ndjson.load(f))
    DATA_BASEBALL.drawing = DATA_BASEBALL.drawing.apply(lambda x: np.array(x))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4e16538" class="outline-2">
<h2 id="org4e16538">实用函数</h2>
<div class="outline-text-2" id="text-org4e16538">
<p>
这里定义一些经常调用的函数。
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">def bar_annotate(draw_rect):
    for rect in draw_rect:
        height = rect.get_height()
        # textcoords is determine the annotate text coords, here `offset points' is represented
        # offset points from xy values.
        ax.annotate('%.2f' %(height, ), xy=(rect.get_x() + rect.get_width() / 2, height),
                    xytext=(0, 3), textcoords='offset points', ha='center', va='bottom')
</pre>
</div>
</div>
</div>

<div id="outline-container-org2ec03b1" class="outline-2">
<h2 id="org2ec03b1">描述信息</h2>
<div class="outline-text-2" id="text-org2ec03b1">
<p>
描述分析，好像我也经习惯了，每拿到一个数据，首先进行描述分析，当我看别人做的分析
报告时，才发现简单的描述分析对于了解整个数据集还是不够的。
</p>
</div>
<div id="outline-container-orga41a2f7" class="outline-3">
<h3 id="orga41a2f7">baseball<sub>bat</sub></h3>
<div class="outline-text-3" id="text-orga41a2f7">
<div class="org-src-container">
<pre class="src src-jupyter-python">count_country = DATA_BASEBALL.countrycode.value_counts()

plt.style.use('ggplot')
fig, ax = plt.subplots(figsize=(9.0, 6.0))
rect = ax.bar(count_country[:10].index, count_country[:10].values)
bar_annotate(rect)
</pre>
</div>


<figure id="org24e3b84">
<img src="./images/have-fun-on-quick-draw-01-923979.png" alt="have-fun-on-quick-draw-01-923979.png">

</figure>

<p>
从上面的图中可以了解到，在Google平台上进行QuickDraw的用户中，属于US的占最多，其
中属于baseball<sub>bat这一项目中就具有56779个用户</sub>。可能的原因是：Google建立于美国
本地，用户量大。
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">DATA_BASEBALL['count_strokes'] = DATA_BASEBALL.drawing.apply(lambda x: np.array(x).shape[0])

mean_strokes = DATA_BASEBALL.count_strokes.groupby(DATA_BASEBALL.countrycode).mean()
fig, ax = plt.subplots(figsize=(9.0, 6.0))
bar = ax.bar(count_country[:10].index, mean_strokes[count_country[:10].index])
bar_annotate(bar)
ax.set_ylim(0, 5)
</pre>
</div>


<figure id="orgcaeb47d">
<img src="./images/have-fun-on-quick-draw-01-104983.png" alt="have-fun-on-quick-draw-01-104983.png">

</figure>


<p>
从上面的图中，在参与人数最多前10的国家中，每一个国家的描绘一个baseball<sub>bat的平均</sub>
笔划都是集中在2.0附近。其中最高的是GB(Great Britain)，最低的是DE(Germany).
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">fig, ax = plt.subplots(3, 3, figsize=(9.0, 6.0))
index = np.random.choice(DATA_BASEBALL.index, 9)
for i, a in zip(index, ax.flatten()):
    drawing = DATA_BASEBALL.drawing[i]
    for draw_line in drawing:
        a.plot(draw_line[0], draw_line[1], '-')
        a.set_axis_off()
</pre>
</div>


<figure id="org06ff83d">
<img src="./images/have-fun-on-quick-draw-01-115375.png" alt="have-fun-on-quick-draw-01-115375.png">

</figure>

<p>
生成一个动态的gif图，快速浏览100张图片的形状。
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">fig, ax = plt.subplots(figsize=(9.0, 6.0))
index = np.random.choice(DATA_BASEBALL.index, 100)
def gif_update(iter_count):
    drawing = DATA_BASEBALL.drawing[iter_count]
    ax.clear()
    for draw_line in drawing:
        ax.plot(draw_line[0], draw_line[1])
        ax.set_axis_off()
anim = FuncAnimation(fig, gif_update, frames=index, interval=5000)
anim.save(path, fps=60, writer='imagemagick')
</pre>
</div>


<figure id="orgdbda682">
<img src="./images/have-fun-on-quick-draw-01-221760.gif" alt="have-fun-on-quick-draw-01-221760.gif">

</figure>
</div>
</div>
</div>

<div id="outline-container-org65e18b3" class="outline-2">
<h2 id="org65e18b3">切割数据</h2>
<div class="outline-text-2" id="text-org65e18b3">
<div class="org-src-container">
<pre class="src src-jupyter-python">
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer">
      <!-- Footer Definition -->
   </footer>

  <!-- Google Analytics Js --><!-- Disqua JS -->
</div>

</div>
<div class="col"></div></div>
</div>
</body>
</html>
